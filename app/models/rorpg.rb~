class Rorpg < ActiveRecord::Base

        def self.dbconn(host, port, username, password, database)
                   return PGconn.new(host, port, '', '', database, username, password)
        end

        def self.dblist(conn)
                return conn.exec("SELECT datname FROM pg_database WHERE datname != 'template0' AND datname != 'template1'")
        end
       	
        def self.schema(conns)
               
		return conns.exec("SELECT schema_name, schema_owner, catalog_name FROM information_schema.schemata
	        WHERE schema_name != 'pg_toast' 
		AND schema_name != 'pg_catalog'
		AND schema_name != 'pg_temp_1'
		AND schema_name != 'pg_toast_temp_1'
		AND schema_name != 'information_schema'")
        end
	
	def self.tables(conntable,schematype)
		return conntable.exec("SELECT table_name FROM information_schema.tables WHERE table_schema='#{schematype}'")
	end
	def self.views(connview,schematype)
		return connview.exec("SELECT table_name FROM information_schema.views WHERE table_schema='#{schematype}'")
	end
        def self.sequences(connsequences,schematype)
		return connsequences.exec("SELECT sequence_name FROM information_schema.sequences WHERE sequence_schema='#{schematype}'")
	end
	def self.functions(connfunctions,schematype)
		return connfunctions.exec("SELECT routine_name FROM information_schema.routines WHERE routine_schema='#{schematype}'")
	end

	def self.info(conninfo,table)
		return conninfo.exec("SELECT * FROM users ")
	end
end
